var Freakylay,connection,ui;!function(o){var e=(r.prototype.setProgress=function(e,t){t=e/t;this.bar.style.strokeDashoffset=this.getCircumference(t),"function"==typeof this.callback&&this.setText(this.callback((Math.round(1e4*t)/100).toFixed(2)))},r.prototype.setText=function(e){this.text.innerHTML=e},r.prototype.getCircumference=function(e){return o.Helper.clamp((1-e)*this.circumference,0,this.circumference)+"px"},r.getCircle=function(e,t){var i=o.Helper.svg("circle");return i.cx.baseVal.value=e,i.cy.baseVal.value=e,i.r.baseVal.value=t,i},r);function r(e,t,i,s){void 0===i&&(i=90),void 0===s&&(s=10),this.parent=e,this.callback=t;e=i/2,t=e-s;this.circumference=t*Math.PI*2,this.text=o.Helper.create("div"),this.bar=r.getCircle(e,t),this.bar.style.strokeDasharray=this.circumference+"px , "+this.circumference+"px";s=o.Helper.svg("svg");s.style.width=i+"px",s.style.height=i+"px";t=r.getCircle(e,t);o.Helper.addClass(t,"remaining"),o.Helper.addClass(this.bar,"progress"),o.Helper.addClass(s,"roundBar"),o.Helper.addClass(this.text,"progressInfo"),s.append(t,this.bar),this.parent.append(this.text,s)}o.CircleBar=e}(Freakylay=Freakylay||{}),function(s){var e=(a.prototype.createInputMenu=function(e){var t=this;this.rElement=this.input(this.r,"r"),this.gElement=this.input(this.g,"g"),this.bElement=this.input(this.b,"b"),this.aElement=this.input(this.a,"a"),this.aInfoElement=s.Helper.create("span"),this.aInfoElement.innerHTML="Not recommended",s.Helper.visibility(this.aInfoElement,!1);function i(){t.internalChange()}this.rElement.oninput=i,this.gElement.oninput=i,this.bElement.oninput=i,this.aElement.oninput=function(){var e=parseInt(t.aElement.value);s.Helper.visibility(t.aInfoElement,t.alphaCheck(e)),i()},e.append(a.label("R:",this.rElement.id),this.rElement,a.label("G:",this.gElement.id),this.gElement,a.label("B:",this.bElement.id),this.bElement,a.label("A:",this.aElement.id),this.aElement,this.aInfoElement)},a.prototype.internalChange=function(){this.changeEvent(this.getColor())},a.prototype.getColor=function(){var e=parseInt(this.rElement.value),t=parseInt(this.gElement.value),i=parseInt(this.bElement.value),s=parseInt(this.aElement.value);return 255===s?"#"+a.to2digitHex(e)+a.to2digitHex(t)+a.to2digitHex(i):"rgba("+[e,t,i,(s/255).toFixed(2)].join(", ")+")"},a.to2digitHex=function(e){e=e.toString(16);return 1===e.length?"0"+e:e},a.prototype.input=function(e,t){var i=s.Helper.create("input");return i.type="range",i.min="0",i.max="255",i.value=e.toString(),i.id="in_"+this.instance+t,i.style.width="80px",i},a.label=function(e,t){var i=s.Helper.create("label");return i.htmlFor=t,i.innerHTML=e,i},a.Instance=0,a);function a(e,t,i){var s,o,r,n;this.instance=a.Instance,a.Instance++,this.changeEvent=t,this.alphaCheck=i,"#"===e.substring(0,1)?(e=7===e.length?e+"FF":e,s=parseInt(e.substring(1,3),16),o=parseInt(e.substring(3,5),16),r=parseInt(e.substring(5,7),16),n=parseInt(e.substring(7,9),16)):((t=e.replace(/ /g,"").split(","))[t.length-1]=t[t.length-1].substring(0,t[t.length-1].length-1),i=t[0].substring(0,4).toLowerCase(),t[0]=t[0].substring(3),n="rgb"===i?(t[0]=t[0].substring(1),255):(t[0]=e[0].substring(2),Math.round(255*parseFloat(t[3]))),s=parseInt(t[0]),o=parseInt(t[1]),r=parseInt(t[2])),this.r=s,this.g=o,this.b=r,this.a=n}s.ColorInput=e}(Freakylay=Freakylay||{}),function(e){var t=(i.prototype.reconnect=function(e){void 0===e&&(e=null),null!=e&&(this.url=e),this.socket.close(),this.connect()},i.prototype.connect=function(){var t=this;this.socket=new WebSocket(this.url),this.socket.onopen=function(e){t.onOpen(e)},this.socket.onmessage=function(e){t.onMessage(e)},this.socket.onclose=function(){t.onClose()}},i.prototype.onOpen=function(e){this.callbacks.open(e)},i.prototype.onClose=function(){this.callbacks.close()},i.prototype.onMessage=function(e){this.callbacks.message(e)},i);function i(e,t,i,s){this.url=e,this.callbacks={message:t,open:i,close:s},this.connect()}e.Connection=t}(Freakylay=Freakylay||{}),function(e){var t=(s.element=function(e){return document.querySelector("#"+e)},s.create=function(e,t){return void 0===t&&(t=""),""===t?document.createElement(e):document.createElementNS(t,e)},s.svg=function(e){return s.create(e,this.SvgNamespace)},s.addClass=function(e,t){e.classList.contains(t)||e.classList.add(t)},s.removeClass=function(e,t){var i=e.className.split(" ").filter(function(e){return e!==t});e.className=i.filter(function(e,t,i){return i.indexOf(e)===t}).join(" ")},s.isset=function(e,t,i){return void 0!==e[t]&&null!==e[t]?e[t]:i},s.clamp=function(e,t,i){return Math.min(i,Math.max(t,e))},s.visibility=function(e,t){e.style.visibility=t?"visible":"hidden"},s.display=function(e,t,i){void 0===i&&(i=!1),e.style.display=t?i?"inline-block":"block":"none"},s.fromUrlColor=function(e){return"rgb"===e.substring(0,3)?e:null===e.match(/[^0-9A-Fa-f]/g)?"#"+e:"#000000"},s.toUrlColor=function(e){return"#"===e.substring(0,1)?e.substring(1):"rgb"===e.substring(0,3)?e:"000000"},s.toggleClass=function(e,t,i){t?s.addClass(e,i):s.removeClass(e,i)},s.stringRepeat=function(e,t){for(var i=e;e.length<t;)i+=e;return i},s.SvgNamespace="http://www.w3.org/2000/svg",s);function s(){}e.Helper=t}(Freakylay=Freakylay||{}),function(t){function e(e){this.InLevel=t.Helper.isset(e,"InLevel",!1),this.LevelPaused=t.Helper.isset(e,"LevelPaused",!1),this.LevelFinished=t.Helper.isset(e,"LevelFinished",!1),this.LevelFailed=t.Helper.isset(e,"LevelFailed",!1),this.LevelQuit=t.Helper.isset(e,"LevelQuit",!1),this.Score=t.Helper.isset(e,"Score",0),this.FullCombo=t.Helper.isset(e,"FullCombo",!1),this.Combo=t.Helper.isset(e,"Combo",0),this.Misses=t.Helper.isset(e,"Misses",0),this.Accuracy=t.Helper.isset(e,"Accuracy",0),this.BlockHitScores=t.Helper.isset(e,"BlockHitScores",[]),this.PlayerHealth=t.Helper.isset(e,"PlayerHealth",0),this.TimeElapsed=t.Helper.isset(e,"TimeElapsed",0)}t.LiveData=e}(Freakylay=Freakylay||{}),function(s){var e=(t.prototype.setValue=function(e){var i=this;this.stop(),this.element.innerHTML=e;var t=window.getComputedStyle(this.element,null);400<parseInt(t.getPropertyValue("width"))&&(this.element.innerHTML+=s.Helper.stringRepeat(" ",Math.floor(e.length/2)),this.internalTimer=window.setInterval(function(){var e=i.element.innerHTML,t=e.substr(0,1);i.element.innerHTML=e.substr(1)+t},this.animationSpeed))},t.prototype.stop=function(){window.clearInterval(this.internalTimer)},t);function t(){this.animationSpeed=250,this.element=s.Helper.element("marquee"),this.internalTimer=null,this.width=0}s.Marquee=e}(Freakylay=Freakylay||{}),function(t){function e(e){this.instantFail=t.Helper.isset(e,"instaFail",!1),this.batteryEnergy=t.Helper.isset(e,"batteryEnergy",!1),this.disappearingArrows=t.Helper.isset(e,"disappearingArrows",!1),this.ghostNotes=t.Helper.isset(e,"ghostNotes",!1),this.fasterSong=t.Helper.isset(e,"fasterSong",!1),this.noFail=t.Helper.isset(e,"noFail",!1),this.noObstacles=t.Helper.isset(e,"noObstacles",!1),this.noBombs=t.Helper.isset(e,"noBombs",!1),this.slowerSong=t.Helper.isset(e,"slowerSong",!1),this.noArrows=t.Helper.isset(e,"noArrows",!1)}t.Modifiers=e}(Freakylay=Freakylay||{}),function(s){var e=(o.prototype.addEndpoint=function(e,t){var i=this;this.connections[e]=new s.Connection(this.getUrl()+e,function(e){e=JSON.parse(e.data),t(e)},function(){o.log(e,"connected!")},function(){o.log(e,"lost connection"),o.log(e,"reconnecting in 5 seconds"),window.setTimeout(function(){i.addEndpoint(e,t)},5e3)})},o.prototype.getUrl=function(e){return void 0===e&&(e=!1),e?this.ip+":"+this.port:"ws:"+this.getUrl(!0)+"/"},o.prototype.reconnect=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null),null!=e&&(this.ip=e),null!=t&&(this.port=t);for(var i=0,s=this.connections;i<s.length;i++)s[i].reconnect(this.getUrl())},o.log=function(e,t){console.log("["+e+"] "+t)},o);function o(e,t){this.connections=[],this.ip=e,this.port=t}s.MultiConnection=e}(Freakylay=Freakylay||{}),function(t){function e(e){this.songSpeedMul=t.Helper.isset(e,"songSpeedMul",1),this.songSpeedMul=Math.round(100*this.songSpeedMul)/100}t.PracticeModeModifiers=e}(Freakylay=Freakylay||{}),function(r){var e=(n.index=0,n);function n(e,t,i){void 0===i&&(i=!1);var s=r.Helper.create("div"),o=r.Helper.create("label");this.element=r.Helper.create("input"),o.htmlFor="input_"+n.index,o.innerHTML=e,this.element.id=o.htmlFor,this.element.type="checkbox",i||(this.element.checked=ui.options[t]),this.element.onclick=function(e){e=!!e.target.checked;i?t(e):ui.options[t]=e,ui.appendNewStyles()},s.append(this.element,o),ui.optionsLinesElement.append(s),n.index++}r.SettingLine=e}(Freakylay=Freakylay||{}),function(t){var e=(i.prototype.getDifficultyString=function(){return"ExpertPlus"!==this.Difficulty?this.Difficulty:"Expert+"},i.prototype.getFullDifficultyLabel=function(){var e=this.getDifficultyString();return""===this.CustomDifficultyLabel||this.CustomDifficultyLabel===e?e:this.CustomDifficultyLabel+" - "+e},i.prototype.getSongAuthorLine=function(){var e=this.SongAuthor;return 0<this.SongSubName.length&&(e+=" <small>"+this.SongSubName+"</small>"),e},i);function i(e){this.Hash=t.Helper.isset(e,"Hash","SongHash"),this.SongName=t.Helper.isset(e,"SongName","SongName"),this.SongSubName=t.Helper.isset(e,"SongSubName","SongSubName"),this.SongAuthor=t.Helper.isset(e,"SongAuthor","SongAuthor"),this.Mapper=t.Helper.isset(e,"Mapper","Mapper"),this.BSRKey=t.Helper.isset(e,"BSRKey","BSRKey"),this.coverImage=t.Helper.isset(e,"coverImage","img/tyGQRx5x_400x400.jpg"),this.Length=t.Helper.isset(e,"Length",1),this.MapType=t.Helper.isset(e,"MapType",0),this.Difficulty=t.Helper.isset(e,"Difficulty","Normal"),this.CustomDifficultyLabel=t.Helper.isset(e,"CustomDifficultyLabel",""),this.BPM=t.Helper.isset(e,"BPM",0),this.NJS=t.Helper.isset(e,"NJS",0),this.PracticeMode=t.Helper.isset(e,"PracticeMode",!1),this.PP=t.Helper.isset(e,"PP",0),this.Star=t.Helper.isset(e,"Star",0),this.Modifiers=new t.Modifiers(t.Helper.isset(e,"Modifiers",{})),this.PracticeModeModifiers=new t.PracticeModeModifiers(t.Helper.isset(e,"PracticeModeModifiers",{})),this.PreviousRecord=t.Helper.isset(e,"PreviousRecord",0),this.PreviousBSR=t.Helper.isset(e,"PreviousBSR",0)}t.StaticData=e}(Freakylay=Freakylay||{}),function(n){var e=(o.prototype.init=function(){var e,t;this.options.previewMode?this.previewGameData():(e=new n.StaticData({}),(t=new n.LiveData({})).InLevel=!1,this.updateStatic(e),this.updateLive(t))},o.prototype.appendNewStyles=function(){var t=this;document.body.style.color=this.options.textColor,document.querySelectorAll(".roundBar circle").forEach(function(e){e.style.stroke=t.options.textColor},this),document.querySelectorAll(".backGroundColor").forEach(function(e){e.style.backgroundColor=t.options.backgroundColor},this),this.options.shortModifierNames?(this.modifiers.instantFail.innerHTML="IF",this.modifiers.batteryEnergy.innerHTML="BE",this.modifiers.disappearingArrows.innerHTML="DA",this.modifiers.ghostNotes.innerHTML="GN",this.modifiers.noFail.innerHTML="NF",this.modifiers.noObstacles.innerHTML="NO",this.modifiers.noBombs.innerHTML="NB",this.modifiers.noArrows.innerHTML="NA",this.modifiers.practiceMode.innerHTML="PM",this.modifiers.fullCombo.innerHTML="FC"):(this.modifiers.instantFail.innerHTML="Insta Fail",this.modifiers.batteryEnergy.innerHTML="Battery Energy",this.modifiers.disappearingArrows.innerHTML="Disappearing Arrows",this.modifiers.ghostNotes.innerHTML="Ghost Notes",this.modifiers.noFail.innerHTML="No Fail",this.modifiers.noObstacles.innerHTML="No Obstacles",this.modifiers.noBombs.innerHTML="No Bombs",this.modifiers.noArrows.innerHTML="No Arrows",this.modifiers.practiceMode.innerHTML="Practice Mode",this.modifiers.fullCombo.innerHTML="Full Combo"),n.Helper.visibility(this.data.previousBSR,this.options.showPrevBsr),n.Helper.visibility(this.data.combo,this.options.showCombo),n.Helper.display(this.data.bpm,this.options.showBpm,!0),n.Helper.display(this.data.njs,this.options.showNjs,!0),n.Helper.display(this.data.miss,this.options.missCounter,!0),n.Helper.display(this.optionsElement,this.options.previewMode),this.options.previewMode&&this.calculateOptionPosition();var e=[],i=n.Helper.toUrlColor(this.options.backgroundColor);i!==this.defaults.backgroundColor&&e.push(this.urlParamStrings.backgroundColor+"="+i);i=n.Helper.toUrlColor(this.options.textColor);i!==this.defaults.textColor&&e.push(this.urlParamStrings.textColor+"="+i);i=function(e,t){n.Helper.toggleClass(e,!t,"borderRadiusTopLeft"),n.Helper.toggleClass(e,!t,"borderRadiusBottomLeft"),n.Helper.toggleClass(e,t,"borderRadiusTopRight"),n.Helper.toggleClass(e,t,"borderRadiusBottomRight")};i(this.songInfo.bsr,this.options.flipStatic),i(this.songInfo.mapper,this.options.flipStatic),i(this.songInfo.difficulty,this.options.flipStatic),i(this.songInfo.artist,this.options.flipStatic),i(this.songInfo.songName,this.options.flipStatic),n.Helper.toggleClass(this.beatMapCover,!this.options.flipStatic,"borderRadiusBottomRight"),n.Helper.toggleClass(this.beatMapCover,this.options.flipStatic,"borderRadiusBottomLeft"),this.options.flipStatic?n.Helper.toggleClass(this.beatMapCover,!this.options.showPrevBsr,"borderRadiusTopLeft"):n.Helper.toggleClass(this.beatMapCover,!this.options.showPrevBsr,"borderRadiusTopRight"),n.Helper.toggleClass(this.songInfoHolder,this.options.flipStatic,"flip"),n.Helper.toggleClass(this.modifiersHolder,this.options.flipModifiers,"flip"),n.Helper.toggleClass(this.dataHolder,this.options.flipLive,"flip"),this.options.ip!==this.defaults.ip&&e.push(this.urlParamStrings.ip+"="+this.options.ip);for(var s=0,o=["shortModifierNames","showPrevBsr","!missCounter","!showBpm","!showNjs","!showCombo","flipStatic","flipLive","flipModifiers","showScoreIncrease","showFullComboModifier"];s<o.length;s++){var r=o[s];"!"!==r.substring(0,1)?this.options[r]&&e.push(this.urlParamStrings[r]):(r=r.substring(1,r.length),this.options[r]||e.push(this.urlParamStrings[r]))}i=0<e.length?"?"+e.join("&"):"";this.urlText.innerHTML=window.location.protocol+"//"+window.location.host+window.location.pathname+i,this.previewGameData()},o.prototype.buildOptionsPanel=function(){var t=this,e=new n.ColorInput(this.options.backgroundColor,function(e){t.options.backgroundColor=e,t.appendNewStyles()},function(e){return e<127||230<e}),i=new n.ColorInput(this.options.textColor,function(e){t.options.textColor=e,t.appendNewStyles()},function(e){return e<127});new n.SettingLine("Short Modifiers","shortModifierNames"),new n.SettingLine("Miss Counter","missCounter"),new n.SettingLine("Previous BSR","showPrevBsr"),new n.SettingLine("BPM","showBpm"),new n.SettingLine("NJS","showNjs"),new n.SettingLine("Combo","showCombo"),new n.SettingLine("Score arrow pointing up or down depending on last score","showScoreIncrease"),new n.SettingLine("Full Combo modifier","showFullComboModifier"),this.optionsLinesElement.append(n.Helper.create("hr")),new n.SettingLine("Flip SongInfo to left","flipStatic"),new n.SettingLine("Flip Modifiers to left","flipModifiers"),new n.SettingLine("Flip Counter section to top","flipLive"),this.optionsLinesElement.append(n.Helper.create("hr")),new n.SettingLine("Test with Background Image",function(e){document.body.style.backgroundImage=e?"url(img/beat-saber-5.jpg)":"none"},!0),e.createInputMenu(n.Helper.element("bgColor")),i.createInputMenu(n.Helper.element("color"))},o.prototype.previewGameData=function(){this.updateStatic(this.staticDataTest),this.updateLive(this.liveDataTest)},o.prototype.getUiElements=function(){var t=this;this.modifiersHolder=n.Helper.element("modifiers"),this.modifiers={instantFail:n.Helper.element("IF"),batteryEnergy:n.Helper.element("BE"),disappearingArrows:n.Helper.element("DA"),ghostNotes:n.Helper.element("GN"),speed:n.Helper.element("speed"),noFail:n.Helper.element("NF"),noObstacles:n.Helper.element("NO"),noBombs:n.Helper.element("NB"),noArrows:n.Helper.element("NA"),practiceMode:n.Helper.element("PM"),songSpeed:n.Helper.element("songSpeed"),fullCombo:n.Helper.element("FC")},this.timer=new n.CircleBar(n.Helper.element("timerHolder")),this.health=new n.CircleBar(n.Helper.element("healthHolder"),function(e){return"<small>Health</small>"+parseFloat(e).toFixed(0)+"%"}),this.accuracy=new n.CircleBar(n.Helper.element("accuracyHolder"),function(e){return"<small>Accuracy</small>"+e+"%"}),this.songInfoHolder=n.Helper.element("songInfo"),this.beatMapCover=n.Helper.element("beatMapCover"),this.songInfo={bsr:n.Helper.element("bsr"),mapper:n.Helper.element("mapper"),difficulty:n.Helper.element("difficulty"),artist:n.Helper.element("artist"),songName:n.Helper.element("mapName"),cover:n.Helper.element("cover")},this.dataHolder=n.Helper.element("downSection"),this.data={score:n.Helper.element("score"),combo:n.Helper.element("combo"),previousBSR:n.Helper.element("previousBSR"),njs:n.Helper.element("njs"),bpm:n.Helper.element("bpm"),miss:n.Helper.element("miss")},this.optionsElement=n.Helper.element("options"),this.optionsLinesElement=n.Helper.element("optionsLines"),this.urlText=n.Helper.element("urlText"),this.marquee=new n.Marquee,this.urlText.onclick=function(){t.urlText.focus(),document.execCommand("copy")},this.ipText=n.Helper.element("ip"),this.changeIp=n.Helper.element("changeIp"),this.changeIp.onclick=function(){var e=t.ipText.value.split(":");e[1]&&void 0!==e[1]||(e[1]="2946"),connection.reconnect(e[0],parseInt(e[1]))}},o.prototype.calculateOptionPosition=function(){var e=window.getComputedStyle(this.optionsElement,null);this.optionsElement.style.marginTop=-parseInt(e.getPropertyValue("height"))/2+"px",this.optionsElement.style.marginLeft=-parseInt(e.getPropertyValue("width"))/2+"px"},o.prototype.getUrlParam=function(e,t){if(!this.urlParams.has(e))return t;e=this.urlParams.get(e);return null===e?t:e},o.prototype.setTime=function(e,t){t<e&&(e=t),this.timer.setText(o.getDate(e)+"<br>"+o.getDate(t)),this.timer.setProgress(e,t)},o.getDate=function(e){var t=e%60,i=Math.floor(e/60),e=t<10?"0"+t:t.toString();return i<0?e:i+":"+t},o.prototype.updateLive=function(e){this.liveData=e,this.options.previewMode||this.liveData.InLevel&&!this.uiShown?(n.Helper.removeClass(this.songInfoHolder,this.inactiveClass),n.Helper.removeClass(this.dataHolder,this.inactiveClass),n.Helper.removeClass(this.modifiersHolder,this.inactiveClass),this.uiShown=!0):!this.liveData.InLevel&&this.uiShown&&(n.Helper.addClass(this.songInfoHolder,this.inactiveClass),n.Helper.addClass(this.dataHolder,this.inactiveClass),n.Helper.addClass(this.modifiersHolder,this.inactiveClass),this.uiShown=!1,this.levelWasPaused=!1,this.marquee.stop()),this.setTime(this.options.previewMode?this.mapLength/2:this.liveData.TimeElapsed,this.mapLength),this.accuracy.setProgress(parseFloat(this.liveData.Accuracy.toFixed(2)),100);var t,i="";this.options.showScoreIncrease&&(i=(t=this.liveData.Score)<(e=this.staticData.PreviousRecord)?"&darr;":e<t?"&uarr;":""),this.data.combo.innerHTML="<span>Combo</span>"+this.liveData.Combo,this.data.miss.innerHTML="<span>MISS</span>"+this.liveData.Misses,this.data.score.innerHTML=i+new Intl.NumberFormat("en-US").format(this.liveData.Score).replace(/,/g," "),this.health.setProgress(this.staticData.Modifiers.noFail?100:parseInt(this.liveData.PlayerHealth.toFixed(0)),100);i=this.options.showFullComboModifier&&this.liveData.FullCombo;n.Helper.visibility(this.modifiersHolder,i),n.Helper.display(this.modifiers.fullCombo,i,!0)},o.prototype.updateStatic=function(e){this.staticData=e,this.mapLength=this.staticData.Length,this.staticData.PracticeMode?this.mapLength=parseInt((this.staticData.Length/this.staticData.PracticeModeModifiers.songSpeedMul).toString()):(this.staticData.Modifiers.fasterSong||this.staticData.Modifiers.slowerSong)&&(this.mapLength=parseInt((this.staticData.Length*(this.staticData.Modifiers.fasterSong?.8:1.15)).toString()));var t,i,s=!0;for(t in this.staticData.Modifiers)this.staticData.Modifiers[t]&&(s=!1),void 0!==this.modifiers[t]&&n.Helper.display(this.modifiers[t],this.staticData.Modifiers[t],!0);n.Helper.display(this.modifiers.practiceMode,this.staticData.PracticeMode,!0),this.staticData.PracticeMode?(s=!1,1!==this.staticData.PracticeModeModifiers.songSpeedMul?(i=void 0,i=1<this.staticData.PracticeModeModifiers.songSpeedMul?this.options.shortModifierNames?"FS":"Faster Song":this.options.shortModifierNames?"SS":"Slower Song",this.modifiers.speed.innerHTML=i,n.Helper.display(this.modifiers.speed,!0,!0)):n.Helper.display(this.modifiers.speed,!1,!0),i=0<(e=parseInt((100*this.staticData.PracticeModeModifiers.songSpeedMul-100).toFixed()))?"+":"",100===e?n.Helper.display(this.modifiers.songSpeed,!1,!0):(n.Helper.display(this.modifiers.songSpeed,!0,!0),this.modifiers.songSpeed.innerHTML=(this.options.shortModifierNames?"":"Speed: ")+i+e+"%"),n.Helper.display(this.modifiers.songSpeed,1!==this.staticData.PracticeModeModifiers.songSpeedMul,!0)):(n.Helper.display(this.modifiers.speed,!1,!0),n.Helper.display(this.modifiers.songSpeed,!1,!0)),this.options.showFullComboModifier&&void 0!==this.liveData&&this.liveData.FullCombo&&(s=!1),n.Helper.visibility(this.modifiersHolder,!s),n.Helper.toggleClass(this.beatMapCover,0===this.staticData.BSRKey.length||"BSRKey"===this.staticData.BSRKey,this.options.flipStatic?"borderRadiusTopRight":"borderRadiusTopLeft"),this.data.previousBSR.innerHTML=0<this.staticData.PreviousBSR.length?"Prev-BSR: "+this.staticData.PreviousBSR:"",o.hideSetting(this.songInfo.bsr,"BSRKey"===this.staticData.BSRKey?"":this.staticData.BSRKey,"BSR: "),o.hideSetting(this.songInfo.mapper,this.staticData.Mapper),o.hideSetting(this.songInfo.artist,this.staticData.getSongAuthorLine()),this.marquee.setValue(this.staticData.SongName),this.songInfo.difficulty.innerHTML=this.staticData.getFullDifficultyLabel(),this.songInfo.cover.style.backgroundImage="url('"+this.staticData.coverImage+"')",this.data.bpm.innerHTML="<span>BPM</span>"+this.staticData.BPM,this.data.njs.innerHTML="<span>NJS</span>"+this.staticData.NJS.toFixed(1),o.insertModifierBreakLines()},o.insertModifierBreakLines=function(){var e=document.querySelectorAll("#modifiers > *"),t=[];e.forEach(function(e){e.classList.contains("modifiers")?t.push(e):e.remove()});for(var i=0,s=t;i<s.length;i++){var o=s[i];"inline-block"===o.style.display&&o.parentNode.insertBefore(n.Helper.create("br"),o.nextSibling)}},o.hideSetting=function(e,t,i){if(void 0===i&&(i=""),0<t.length)return n.Helper.visibility(e,!0),void(e.innerHTML=i+t);n.Helper.visibility(e,!1)},o);function o(){var t=this;this.inactiveClass="inactive",this.staticDataTest=new n.StaticData({}),this.staticDataTest.BPM=180,this.staticDataTest.BSRKey="1234",this.staticDataTest.Difficulty="ExpertPlus",this.staticDataTest.Length=120,this.staticDataTest.NJS=20,this.staticDataTest.PreviousBSR="affa",this.staticDataTest.PreviousRecord=123456,this.staticDataTest.CustomDifficultyLabel="CustomDifficulty",this.staticDataTest.Modifiers.batteryEnergy=!0,this.staticDataTest.Modifiers.disappearingArrows=!0,this.staticDataTest.Modifiers.ghostNotes=!0,this.staticDataTest.Modifiers.instantFail=!1,this.staticDataTest.Modifiers.noArrows=!0,this.staticDataTest.Modifiers.noBombs=!1,this.staticDataTest.Modifiers.noFail=!1,this.staticDataTest.Modifiers.noObstacles=!0,this.staticDataTest.PracticeMode=!0,this.staticDataTest.PracticeModeModifiers.songSpeedMul=1.2,this.liveDataTest=new n.LiveData({}),this.liveDataTest.PlayerHealth=.5,this.liveDataTest.TimeElapsed=10,this.liveDataTest.Accuracy=50,this.liveDataTest.Score=1234567,this.liveDataTest.Misses=17,this.liveDataTest.FullCombo=!0,this.defaults={ip:"127.0.0.1",textColor:"ffffff",backgroundColor:"rgba(255,133,255,0.7)"},this.urlParamStrings={ip:"ip",backgroundColor:"a",textColor:"b",shortModifierNames:"c",showPrevBsr:"d",missCounter:"e",showBpm:"f",showNjs:"g",showCombo:"h",flipStatic:"i",flipLive:"j",flipModifiers:"k",showScoreIncrease:"l",showFullComboModifier:"m"},this.urlParams=new URLSearchParams(location.search),this.options={backgroundColor:n.Helper.fromUrlColor(this.getUrlParam(this.urlParamStrings.backgroundColor,this.defaults.backgroundColor)),textColor:n.Helper.fromUrlColor(this.getUrlParam(this.urlParamStrings.textColor,this.defaults.textColor)),shortModifierNames:this.urlParams.has(this.urlParamStrings.shortModifierNames),showPrevBsr:this.urlParams.has(this.urlParamStrings.showPrevBsr),previewMode:this.urlParams.has("options"),missCounter:!this.urlParams.has(this.urlParamStrings.missCounter),showBpm:!this.urlParams.has(this.urlParamStrings.showBpm),showNjs:!this.urlParams.has(this.urlParamStrings.showNjs),showCombo:!this.urlParams.has(this.urlParamStrings.showCombo),ip:this.getUrlParam(this.urlParamStrings.ip,this.defaults.ip),flipLive:this.urlParams.has(this.urlParamStrings.flipLive),flipStatic:this.urlParams.has(this.urlParamStrings.flipStatic),flipModifiers:this.urlParams.has(this.urlParamStrings.flipModifiers),showScoreIncrease:this.urlParams.has(this.urlParamStrings.showScoreIncrease),showFullComboModifier:this.urlParams.has(this.urlParamStrings.showFullComboModifier)},document.body.ondblclick=function(e){e.target===t.songInfoHolder&&(t.options.previewMode=!t.options.previewMode,t.appendNewStyles())},this.getUiElements(),this.health.setProgress(0,1),this.accuracy.setProgress(0,0),this.setTime(0,60),this.uiShown=!0,this.appendNewStyles(),window.setTimeout(function(){t.calculateOptionPosition()},100)}n.UI=e}(Freakylay=Freakylay||{}),function(e){var t=(i.prototype.isDefaultValue=function(){return this.value===this.default},i);function i(e,t,i){void 0===i&&(i=null);var s=new URLSearchParams(location.search);this.key=e,this.default=t,this.hasKey=s.has(this.key),this.value=this.hasKey?s.get(this.key):this.default,"function"==typeof i&&(this.value=i(this.value))}e.UrlParam=t}(Freakylay=Freakylay||{}),window.onload=function(){console.log("If you don't have the BSDataPuller mod then download the latest release from here and place it in your BS mods folder: https://github.com/kOFReadie/DataPuller/releases/latest"),(ui=new Freakylay.UI).init(),ui.buildOptionsPanel(),(connection=new Freakylay.MultiConnection(ui.options.ip,2946)).addEndpoint("BSDataPuller/LiveData",function(e){e=new Freakylay.LiveData(e),ui.updateLive(e)}),connection.addEndpoint("BSDataPuller/StaticData",function(e){e=new Freakylay.StaticData(e),ui.updateStatic(e)}),ui.ipText.value=connection.getUrl(!0)};